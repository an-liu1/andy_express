(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03b59e14"],{"136b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ml-4 mb-5"},[a("div",[a("el-breadcrumb",{staticClass:"border el-breadcrumb-outer",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{staticClass:"mt-3 ml-3"},[e._v("投诉与建议")]),!1===e.addAdviceSign?a("el-button",{staticClass:"float-right mr-3",staticStyle:{"margin-top":"5px"},attrs:{type:"primary"},on:{click:e.switchAddAdvice}},[e._v(" 填写建议 "),a("i",{staticClass:"el-icon-warning fa-lg"})]):e._e()],1),a("el-collapse-transition",[!0===e.addAdviceSign?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mt-5"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm form",attrs:{model:e.ruleForm,rules:e.rules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"投诉类型",prop:"adviceType"}},[a("el-radio-group",{model:{value:e.ruleForm.adviceType,callback:function(t){e.$set(e.ruleForm,"adviceType",t)},expression:"ruleForm.adviceType"}},[a("el-radio",{attrs:{label:"投诉"}},[e._v("投诉")]),a("el-radio",{attrs:{label:"建议"}},[e._v("建议")]),a("el-radio",{attrs:{label:"其他"}},[e._v("其他")])],1)],1),a("el-form-item",{attrs:{label:"投诉标题",prop:"adviceTitle"}},[a("el-input",{staticClass:"input-width",model:{value:e.ruleForm.adviceTitle,callback:function(t){e.$set(e.ruleForm,"adviceTitle",t)},expression:"ruleForm.adviceTitle"}})],1),a("el-form-item",{attrs:{label:"投诉内容",prop:"adviceContent"}},[a("el-input",{staticClass:"input-width",attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.ruleForm.adviceContent,callback:function(t){e.$set(e.ruleForm,"adviceContent",t)},expression:"ruleForm.adviceContent"}})],1),a("el-form-item",{attrs:{label:"投诉照片",prop:"evidentPicture"}},[a("el-upload",{attrs:{drag:"",action:"https://upload-z2.qiniup.com",data:e.token,"on-remove":e.handleRemove,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"list-type":"picture"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" 拖拽照片 或者 "),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip text-danger",staticStyle:{"font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[a("i",{staticClass:"fas fa-exclamation-circle mr-2"}),e._v("上传照片只支持PNG，GIF，JPEG 和 JPG格式，大小不超过1MB。*每次只能上传一张图片 ")])])],1)],1),a("div",{staticStyle:{width:"100%","margin-bottom":"20px"}},[a("div",{staticStyle:{overflow:"hidden",position:"relative",margin:"auto",left:"0",top:"0",width:"172px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.addAdvice}},[e._v(" 上传 ")]),a("el-button",{attrs:{type:"warning"},on:{click:e.switchAddAdvice}},[e._v(" 取消 ")])],1)])],1):e._e()]),a("div",{staticClass:"mt-5"},[a("el-table",{staticClass:"borderRadius",attrs:{data:e.tableData,"highlight-current-row":"",border:"","default-sort":{prop:"adviceDate",order:"descending"}}},[a("el-table-column",{attrs:{fixed:"",prop:"adviceDate",label:"投诉时间",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e._f("moment")(i.adviceDate,"timezone","Asia/Shanghai","YYYY-MM-DD HH:mm:ss")))])]}}])}),a("el-table-column",{attrs:{fixed:"",prop:"adviceType",label:"投诉类型",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["投诉"===i.adviceType?a("span",{staticClass:"text-danger"},[e._v("投诉")]):e._e(),"建议"===i.adviceType?a("span",{staticClass:"text-danger"},[e._v("建议")]):e._e(),"其他"===i.adviceType?a("span",{staticClass:"text-danger"},[e._v("其他")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"adviceTitle",label:"投诉标题",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.adviceTitle))])]}}])}),a("el-table-column",{attrs:{prop:"adviceContent",label:"投诉详细内容",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.adviceContent))])]}}])}),a("el-table-column",{attrs:{prop:"picture",label:"证据照片",align:"center",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.picture.length>1?a("el-carousel",{attrs:{"indicator-position":"none",height:"150px"}},e._l(i.picture,(function(t,r){return a("el-carousel-item",{key:r},[a("img",{staticClass:"img-fluid pointer",attrs:{src:t.src},on:{click:function(t){return e.showMultiple(i,r)}}})])})),1):1===i.picture.length?a("el-image",{staticClass:"img-fluid",staticStyle:{height:"150px"},attrs:{src:i.picture[0].src,"preview-src-list":[i.picture[0].src],fit:"cover"}}):a("span",[e._v("暂无图片")]),a("vue-easy-lightbox",{attrs:{visible:e.lightboxVisible,imgs:e.img,index:e.index},on:{hide:e.handleHide}})]}}])}),a("el-table-column",{attrs:{prop:"adviceImprovement",label:"改善办法",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.adviceImprovement?a("span",{staticClass:"text-success"},[e._v(e._s(i.adviceImprovement))]):a("span",{staticClass:"text-danger"},[e._v("客服正在处理中 敬请期待")])]}}])})],1),a("pagination",{staticClass:"mt-5 float-right",attrs:{data:e.tableData,pager:"prev, pager, next, jumper, ->, total, slot",limitNumber:"5"},on:{pagechange:e.pageChange}})],1)],1)])},r=[],n=(a("c975"),a("d81d"),a("a434"),a("750b")),l=a("6121"),c=a("3803"),o={components:{pagination:c["a"]},setup:function(e,t){var a=t.root,i=a.$store,r=a.$message;Object(n["d"])((function(){i.dispatch("getUserAdvice",{page:"0",size:"5"}),i.dispatch("getUpToken")}));var c=Object(n["f"])(!1),o=Object(n["a"])((function(){return i.state.advicelist})),s=Object(n["c"])("reload"),d=Object(n["f"])(!1),u=Object(n["f"])([]),p=function(){d.value=!d.value},v=Object(n["e"])({adviceType:"orderComplaint",adviceTitle:"",adviceContent:"",evidentPicture:[]}),m=function(){var e={advice_type:v.adviceType,advice_title:v.adviceTitle,advice_content:v.adviceContent,evident_image:v.evidentPicture};""===e.advice_title?r.error("请填写投诉信息的标题"):""===e.advice_content?r.error("请填写投诉信息的内容"):0===e.evident_image.length?r.error("请上传货物的事故照片"):(c.value=!0,i.dispatch("createAdvice",e).then((function(){r.success("投诉提交成功！"),c.value=!1,s()})).catch((function(){c.value=!1})))},g=Object(n["a"])((function(){return o.value.map((function(e){return{adviceDate:e.createdAt,adviceType:e.advice_type,picture:e.evident_image.map((function(e){return{src:l["a"]+e}})),adviceTitle:e.advice_title,adviceContent:e.advice_content,adviceImprovement:e.advice_improvement}}))})),f=Object(n["e"])({adviceType:[{required:!0,message:"请输入投诉类型",trigger:"blur"}],adviceTitle:[{required:!0,message:"请输入投诉标题",trigger:"blur"}],adviceContent:[{required:!0,message:"请输入具体投诉内容",trigger:"blur"}],evidentPicture:[{required:!0,message:"请选择问题照片",trigger:"blur"}]}),b=Object(n["a"])((function(){return i.state.token})),h=function(e){var t=!0,a=["image/gif","image/jpeg","image/jpg","image/png"],i=e.size/1024/1024<1;return-1==a.indexOf(e.type)&&(r.error("上传文件应该是图片格式！"),t=!1),i||(r.error("图片大小超过1MB了哦！"),t=!1),t},_=function(e){var t=v.evidentPicture.indexOf(e.response.key);v.evidentPicture.splice(t,1)},y=function(e){i.dispatch("getUpToken").then((function(){v.evidentPicture.push(e.key),u.value.push(e.key)}))},C=Object(n["f"])(!1),x=Object(n["f"])(0),w=Object(n["f"])(""),k=function(){C.value=!1},T=function(e,t){C.value=!0,w.value=e.picture,x.value=t},A=function(e){i.dispatch("getUserAdvice",{page:e-1,size:5})};return{loading:c,addAdviceSign:d,switchAddAdvice:p,addAdvice:m,tableData:g,adviceList:o,pageChange:A,ruleForm:v,rules:f,imageUrl:u,beforeAvatarUpload:h,handleAvatarSuccess:y,handleRemove:_,lightboxVisible:C,img:w,index:x,showMultiple:T,handleHide:k,token:b}}},s=o,d=(a("bdba"),a("2877")),u=Object(d["a"])(s,i,r,!1,null,null,null);t["default"]=u.exports},3803:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-pagination",{attrs:{background:"",layout:e.pagerLayout,"current-page":e.currentPage},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})},r=[],n=a("750b"),l={name:"pagination",props:["pager","data","limitNumber"],setup:function(e,t){var a=t.emit,i=Object(n["a"])((function(){return e.data.length>=e.limitNumber?e.pager:"prev, pager, jumper, ->, total, slot"})),r=Object(n["f"])(),l=function(e){r.value=e,a("pagechange",e)};return{pagerLayout:i,currentPage:r,handleCurrentChange:l}}},c=l,o=a("2877"),s=Object(o["a"])(c,i,r,!1,null,null,null);t["a"]=s.exports},"7b2a":function(e,t,a){},a434:function(e,t,a){"use strict";var i=a("23e7"),r=a("23cb"),n=a("a691"),l=a("50c4"),c=a("7b0b"),o=a("65f0"),s=a("8418"),d=a("1dde"),u=a("ae40"),p=d("splice"),v=u("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,g=Math.min,f=9007199254740991,b="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!p||!v},{splice:function(e,t){var a,i,d,u,p,v,h=c(this),_=l(h.length),y=r(e,_),C=arguments.length;if(0===C?a=i=0:1===C?(a=0,i=_-y):(a=C-2,i=g(m(n(t),0),_-y)),_+a-i>f)throw TypeError(b);for(d=o(h,i),u=0;u<i;u++)p=y+u,p in h&&s(d,u,h[p]);if(d.length=i,a<i){for(u=y;u<_-i;u++)p=u+i,v=u+a,p in h?h[v]=h[p]:delete h[v];for(u=_;u>_-i+a;u--)delete h[u-1]}else if(a>i)for(u=_-i;u>y;u--)p=u+i-1,v=u+a-1,p in h?h[v]=h[p]:delete h[v];for(u=0;u<a;u++)h[u+y]=arguments[u+2];return h.length=_-i+a,d}})},bdba:function(e,t,a){"use strict";var i=a("7b2a"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-03b59e14.c0982f99.js.map